{
    "Comment": "First Serv Carga",
    "StartAt": "Obtener/Update el contador",
    "States": {
        "Obtener/Update el contador": {
            "Type": "Task",
            "Resource": "${DDBUpdateItem}",
            "Parameters": {
                "TableName": "${TABLE_NAME_TRAMAS}",
                "Key": {
                    "pk": {
                        "S": "NUMERATOR"
                    },
                    "sk": {
                        "S": "NUMERATOR"
                    }
                },
                "ExpressionAttributeValues": {
                    ":IdCarga": {
                        "N": "1"
                    }
                },
                "UpdateExpression": "ADD IdCarga :IdCarga",
                "ReturnValues": "ALL_NEW"
            },
            "OutputPath": "$.Attributes",
            
            "Next": "Insertar carga"
        },

        "Insertar carga": {
            "Type": "Task",
            "Resource": "${DDBUpdateItem}",
            "Parameters": {
                "TableName": "${TABLE_NAME_TRAMAS}",
                "Key": {
                    "pk":{
                        "S.$":"$.IdCarga.N"
                    },
                    "sk":{
                        "S":"PROCESO"
                    }
                },
                "ExpressionAttributeValues": {
                    ":tipo":{
                        "S.$":"$$.Execution.Input.tipo"
                    },
                    ":poliza":{
                        "S.$":"$$.Execution.Input.poliza"
                    },
                    ":contratante":{
                        "S.$":"$$.Execution.Input.contratante"
                    },
                    ":producto":{
                        "S.$":"$$.Execution.Input.producto"
                    },
                    ":canalDeVenta":{
                        "S.$":"$$.Execution.Input.canalDeVenta"
                    },
                    ":transaccion":{
                        "S.$":"$$.Execution.Input.transaccion"
                    },
                    ":periodoDeclaracion":{
                        "S.$":"$$.Execution.Input.periodoDeclaracion"
                    },
                    ":ruc":{
                        "S.$":"$$.Execution.Input.ruc"
                    },
                    ":fechaCreacion":{
                        "S.$":"$$.Execution.StartTime"
                    }
                },
                "UpdateExpression": "SET tipo = :tipo, poliza = :poliza, contratante = :contratante, producto = :producto, canalDeVenta = :canalDeVenta, transaccion = :transaccion, periodoDeclaracion = :periodoDeclaracion, ruc = :ruc, fechaCreacion = :fechaCreacion"
            },
            "End": true
        }
    }
}